# UI 更新总结

## 更新内容

### 1. 左右分栏布局

**左侧（50%宽度）**：
- 聊天消息列表
- 输入框
- 实时流式响应显示

**右侧（50%宽度）**：
- 代码可视化区域
- 视图切换标签
- 支持两种视图模式

### 2. 视图切换功能

右侧提供两个视图模式，可以通过标签切换：

#### 🌐 预览视图（Preview）
- 显示运行中的应用
- 支持沙盒 URL（优先）
- 支持浏览器预览（降级）
- 响应式 iframe 显示

#### 📁 代码库视图（Codebase）
- 左侧：文件树导航
  - 树形结构显示
  - 文件夹展开/折叠
  - 文件选择高亮
- 右侧：代码编辑器
  - Monaco Editor
  - 语法高亮
  - 行号显示
  - 代码只读模式

### 3. 新增组件

#### CodebaseView.tsx
- 文件树构建和显示
- 文件选择功能
- 代码编辑器集成
- 语法高亮支持

#### WebPreview.tsx
- Web 应用预览
- 沙盒 URL 支持
- 浏览器预览降级
- 加载状态显示

### 4. UI 改进

- **Header 更新**：
  - 显示代码生成状态
  - 添加"在新窗口打开"链接（如果有沙盒）
  
- **空状态**：
  - 代码未生成时显示提示信息
  - 引导用户开始对话

- **标签切换**：
  - 清晰的视觉反馈
  - 平滑的过渡动画
  - 活跃状态高亮

## 设计特点

### 参考 Lovable 风格
- 简洁的布局
- 清晰的视觉层次
- 现代化的交互

### 用户体验
- 实时反馈
- 直观的导航
- 响应式设计

## 文件结构

```
frontend/src/
├── pages/
│   └── ChatPage.tsx          # 主页面（已更新）
├── components/
│   ├── CodebaseView.tsx     # 代码库视图（新增）
│   ├── WebPreview.tsx       # Web 预览（新增）
│   ├── ChatMessage.tsx      # 聊天消息
│   └── ChatInput.tsx        # 输入框
```

## 使用流程

1. **用户描述需求**
   - 在左侧输入框输入
   - 实时显示 AI 响应

2. **代码生成**
   - AI 团队协作生成代码
   - 右侧自动显示代码可视化

3. **查看代码**
   - 切换到"代码库"视图
   - 浏览文件树
   - 查看代码内容

4. **预览应用**
   - 切换到"预览"视图
   - 查看运行中的应用
   - 支持沙盒环境

## 技术实现

### 文件树构建
```typescript
function buildFileTree(files: Record<string, string>): FileNode[]
```
- 将扁平文件结构转换为树形结构
- 支持嵌套文件夹
- 自动处理路径分隔

### 视图切换
```typescript
const [viewMode, setViewMode] = useState<ViewMode>('preview')
```
- 状态管理
- 条件渲染
- 平滑切换

### 代码编辑器
- Monaco Editor 集成
- 自动语言检测
- 语法高亮
- 只读模式

## 下一步优化

1. **代码编辑功能**
   - 允许用户编辑代码
   - 实时保存
   - 重新部署

2. **文件操作**
   - 创建新文件
   - 删除文件
   - 重命名文件

3. **搜索功能**
   - 文件搜索
   - 代码搜索
   - 快速跳转

4. **性能优化**
   - 虚拟滚动（文件树）
   - 代码分割
   - 懒加载

## 完成状态

✅ **所有功能已实现**

- ✅ 左右分栏布局
- ✅ 视图切换
- ✅ 代码库视图
- ✅ Web 预览视图
- ✅ 文件树导航
- ✅ 代码编辑器
- ✅ 响应式设计

现在可以刷新浏览器查看新界面！
